{% extends "base.html" %}
{%block title%}Romskjema - oversikt bygg{% endblock %}
{% block header %}Bygg{% endblock %}



{%block page_subtitle %}Ventilasjonsystemer{% endblock %}
{%block content %}
    {% if system %}
    Systeminformasjon {{system}}
    {% else %}
    <!-- New system form -->
    <div class="split-container-left no-print">
      <input type="text" name="project_id" id="project_id" value="{{project.id}}" hidden readonly>
      <p>
        Legg til system <br>
          <form class="custom-form profile-form" id="system" method="POST" role="form">
              Systemnummer <br>
              <input type="text" name="system_number" id="system_number" placeholder="Systemnummer" tabindex="1" required>
              <br>
              <br>
              Aggregatplassering <br>
              <input type="text" name="system_placement" id="system_placement" placeholder="Plassering" tabindex="2" required>
              <br>
              <br>
              Betjeningsomr책de <br>
              <input type="text" name="system_service" id="system_service" placeholder="Betjeningsomr책de" tabindex="3">
              <br>
              <br>
              Luftmengde tatt ut <br>
              <input type="text" name="airflow" id="airflow" placeholder="Luftmengde" tabindex="4">
              <br>
              <br>
              <select id="heat_exchange" name="heat_exchange" tabindex="5">
                <option value="none">- Gjenvinner -</option>
                <option value="R">Roterende</option>
                <option value="P">Plate/kryss</option>
                <option value="B">Batteri</option>
                <option value="0">Ingen</option>
              </select>
              <br>
              <br>
              <label>Spesialsystem<br>
                  <input type="checkbox" id="special_system" name="special_system" tabindex="6"></label>
              <br>
  
              <button type="submit" class="form-button" tabindex="7">Legg til</button>
          </form>
      </p>
    </div>

  <div class="split-container-right">
    <div class="table-header-container">
        <table class="table-wrapper tableView">
          <thead>
            <tr class="table-header">
              <th class="table-id-cell">
              </th>
              <th class="table-cell ">
                Systemnr
              </th>
              <th class="table-cell table-cell-long">
                Plassering
              </th>   
              <th class="table-cell table-cell-long">
                Betjeningsomr책de
              </th>
              <th class="table-cell ">
                Viftekapasitet
              </th>
              <th class="table-cell ">
                
                <div class="table-description-dropdown">Gjenvinner
                  <div class="table-description-dropdown-content">
                      R: roterende<br>
                      P: plate/kryss <br>
                      B: batteri
                    </div>
                  </div>
              </th>
              <th class="table-cell ">
                Tilluft
              </th>
              <th class="table-cell ">
                Avtrekk
              </th>
              <th class="table-cell table-cell-long">
                Spesialsystem
              </th>
              <th class="table-cell table-cell-long">
                Kommentar
              </th>
              <th class="table-cell no-print">
              </th>
            </tr>
          </thead>
        </table>
      </div>
    

      <div class="table-container">
        <table id="systemsTableVentilation" class="table-wrapper">
          <tbody>
            {% for system in systems %}
              {% if system.SpecialSystem == "" %}
              <tr class="table-row">
                <td hidden-data-column="system_id" class="table-id-cell">
                  <span class="hidden-text">{{system.id}}</span>
                </td>
                <td class="table-cell" data-column="system_number">
                  {{system.SystemName}}
                </td>
                <td class="table-cell table-cell-long" data-column="system_location">
                  {{system.Location}}
                </td>
                <td class="table-cell table-cell-long" data-column="service_area">
                  {{system.ServiceArea}}
                </td>
                <td class="table-cell" data-column="airflow">
                  {{system.AirFlow}} m3/h
                </td>
                <td class="table-cell" data-column="system_hx">
                  {% if system.HeatExchange == None %}
                  
                  {% else %}
                  {{system.HeatExchange}}
                  {% endif %}
                </td>
                <td class="table-cell">
                  {{system.AirFlowSupply}} m3/h
                </td>
                <td class="table-cell">
                  {{system.AirFlowExtract}} m3/h
                </td>
                <td class="table-cell table-cell-long">
                  {{system.SpecialSystem}}
                </td>
                <td class="table-cell table-cell-long">
                  {% if system.AirFlowSupply != None %}
                    {% if system.AirFlowSupply > system.AirFlow %}
                      Prosjektert m3 > aggregat.
                    {% elif system.AirFlowSupply != system.AirFlowExtract %}
                      Ubalanse p책 systemet.
                    {% endif %}
                  {% endif %}
                </td>
                <td id="delete" class="table-cell no-print">
                  <form><button class="table-button" onclick="deleteSystem(event)">Slett system</button></form>
                </td>
                </tr>
                {% endif %}
              {% endfor %}

                  <tr class="table-row">
                    <td>
                      <br>
                    </td>
                  </tr>
                <tr class="table-row">
                  <td class="table-id-cell">

                  </td>
                  <td class="table-cell">
                    Spesialsystemer
                  </td>
                </tr>

              {% for system in systems %}
              {% if system.SpecialSystem == "Ja" %}
              <tr class="table-row">
                <td hidden-data-column="system_id" class="table-id-cell">
                  <span class="hidden-text">{{system.id}}</span>
                </td>
                <td class="table-cell" data-column="system_number">
                  {{system.SystemName}}
                </td>
                <td class="table-cell table-cell-long" data-column="system_location">
                  {{system.Location}}
                </td>
                <td class="table-cell table-cell-long" data-column="service_area">
                  {{system.ServiceArea}}
                </td>
                <td class="table-cell" data-column="airflow">
                  {{system.AirFlow}} m3/h
                </td>
                <td class="table-cell" data-column="system_hx">
                </td>
                <td class="table-cell">
                  {{system.AirFlowSupply}} m3/h
                </td>
                <td class="table-cell">
                  {{system.AirFlowExtract}} m3/h
                </td>
                <td class="table-cell table-cell-long">
                  {{system.SpecialSystem}}
                </td>
                <td class="table-cell table-cell-long">
                  {% if system.AirFlowSupply %}
                  {% if system.AirFlowSupply > system.AirFlow or system.AirFlowExtract > system.AirFlow %}
                      Prosjektert m3 > system.
                  {% endif %}
                  {% endif %}
                </td>
                <td id="delete" class="table-cell no-print">
                  <form><button class="table-button" onclick="deleteSystem(event)">Slett system</button></form>
                </td>
                </tr>
                {% endif %}
              {% endfor %}


            </tbody>
          </table>
      
      </div>
    </div>

    <!-- End new system form -->
    {% endif %}
    <script src="{{ url_for('static', filename='/js/system_table.js') }}"></script>
{% endblock %}
