{% extends "base.html" %}
{%block title%}Romskjema - romliste{% endblock %}
{% block header %}Ventilasjon{% endblock %}


{%block page_subtitle %}
Luftmengdetabell 
{% if building%}
  - {{building.BuildingName}} 
{% else %}
  alle bygg
{% endif %}
{% endblock %}
{%block content %}
    <div class="ventilation-system-sorting-container">
      <div class="building-selector-container">
        <form id="project_building" method="POST">
          <select name="project_building" onchange="showBuildings()">
            <option value="none">- Velg bygg -</option>
            <option value="showall">Alle</option>
            {% for building in project_buildings %}
            <option value="{{building.id}}">{{building.BuildingName}}</option>
            {% endfor %}
          </select>
        </form>
      </div>
    </div>
    <!-- End new room form -->
    
<div class="table-header-container">
  <table class="table-wrapper tableView">
    <thead>
      <tr class="table-header">
        <th class="table-id-cell table-cell-small">
          id
        </th>
        <th class="table-cell table-cell-medium">
          Bygg
        </th>
        
        <th class="table-cell table-cell-small">
          Etasje
        </th>
                
        <th class="table-cell table-cell-medium">
          Romnr
        </th>
        
        <th class="table-cell">
          Romnavn
        </th>

        <th class="table-cell">
            Personer summert
        </th>

        <th class="table-cell">
            Emisjon summert
        </th>

        <th class="table-cell">
            Prosess
        </th>

        <th class="table-cell">
          Minimum
        </th>

        <th class="table-cell">
            Dimensjonert
        </th>

        <th class="table-cell">
            Tilluft
        </th>

        <th class="table-cell">
            Avtrekk
        </th>

        <th class="table-cell">
            m<sup>3</sup>/m<sup>2</sup>
        </th>

        <th class="table-cell">
            System
        </th>
        <th class="table-cell table-cell-long">
            Kommentarer
        </th>

      </tr>
    </thead>
  </table>
</div>
<div class="table-container">
  <table id="roomsTableVentilation" class="table-wrapper tableView">
    <tbody>
      {% for data in ventilation_data %}
      <tr class="table-row">
        <td class="table-cell table-cell-small" data-column="vent_data_id">
          {{data.id}}
        </td>
        <td class="table-cell table-cell-medium">
          {{data.room_ventilation.building.BuildingName}}
        </td>
        <td class="table-cell table-cell-small">
          {{data.room_ventilation.Floor}}
        </td>
        <td class="table-cell table-cell-medium">
          {% if building %}
          <a href="{{ url_for('ventilation.ventilation', building_id=building.id, room_id=data.room_ventilation.id)}}">{{data.room_ventilation.RoomNumber}} </a> 
          {% else %}
          {{data.room_ventilation.RoomNumber}} 
          {% endif %}
        </td>
        <td class="table-cell">
          {{data.room_ventilation.RoomName}}
        </td>
        <td class="table-cell">
          {{data.AirPersonSum}} m<sup>3</sup>/h
        </td>
        <td class="table-cell">
          {{data.AirEmissionSum}} m<sup>3</sup>/h
        </td>
        <td class="table-cell">
            {{data.AirProcess}} m<sup>3</sup>/h
        </td>
        <td class="table-cell">
          {{data.AirMinimum}} m<sup>3</sup>/h
        </td>
        <td class="table-cell">
            {{data.AirDemand}} m<sup>3</sup>/h
        </td>
        <td class="table-cell supplyCell" data-column="supply_air">
            {{data.AirSupply}} m<sup>3</sup>/h
        </td>
        <td class="table-cell extractCell" data-column="extract_air">
            {{data.AirExtract}} m<sup>3</sup>/h
        </td>
        <td class="table-cell">
            {{data.AirChosen}} m<sup>3</sup>/m<sup>2</sup>
        </td>
        <td class="table-cell" data-column="system_id">         
          
          <form id="system" method="POST">  
            <select class="table-select" name="system_id" id="system_id">
              {% if not data.room.SystemName %}
                <option value="none">- System -</option>
              {% else %}
                <option value="{{data.SystemId}}">- {{data.room.SystemName}} -</option>
              {% endif %}
              
              {% for system in system_names %}
                {% if system.SystemName != data.room.SystemName %}
                  <option value="{{system.id}}">{{system.SystemName}}</option>
                {% endif %}
              {% endfor %}
            </select>
          </form>

        </td>
        <td class="table-cell table-cell-long" data-column="comment">
            {% if data.AirSupply < data.AirDemand %}
              Tilluft under krav. 
            {% endif %}
            {% if data.AirSupply != data.AirExtract %}
              Ubalanse i rom. 
            {% endif %}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
<script src="{{ url_for('ventilation.static', filename='ventilation_table.js') }}"></script>
{% endblock %}
